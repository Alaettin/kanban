<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resilience – Workspace</title>
  <link rel="stylesheet" href="/apps/resilience/styles.css?v=14" />
</head>
<body>
  <header class="app-header">
    <a href="/dashboard" class="header-back-btn" title="Zurück zum Dashboard">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 18l-6-6 6-6"/></svg>
    </a>
    <div class="brand">
      <svg class="brand-icon" viewBox="0 0 24 24">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
      </svg>
      <span id="brand-text">Resilience</span>
    </div>
    <div class="header-spacer"></div>
    <div id="global-import-status" class="global-import-status" hidden>
      <div class="global-import-bar-track"><div class="global-import-bar" id="global-import-bar"></div></div>
      <span id="global-import-text" class="global-import-text">0/0</span>
    </div>
    <div class="user-menu-wrap">
      <button id="user-menu-toggle" class="user-avatar-btn" type="button" aria-haspopup="true" aria-expanded="false">
        <span id="user-initials">--</span>
      </button>
      <div id="user-menu" class="user-menu" hidden>
        <div id="user-info" class="user-menu-info"></div>
        <div class="user-menu-section">
          <div class="locale-switch" role="radiogroup" aria-label="Sprache">
            <button id="locale-de-btn" class="locale-switch-btn active" type="button" role="radio" aria-checked="true">DE</button>
            <button id="locale-en-btn" class="locale-switch-btn" type="button" role="radio" aria-checked="false">EN</button>
          </div>
        </div>
        <button id="logout-btn" class="user-menu-item" type="button">Logout</button>
      </div>
    </div>
  </header>

  <div class="app-layout">
    <aside id="sidebar" class="sidebar" aria-label="Navigation">
      <nav id="sidebar-nav" class="sidebar-nav">
        <button class="sidebar-item active" data-page="dashboard" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <rect x="3" y="3" width="7" height="9" rx="1"/>
            <rect x="14" y="3" width="7" height="5" rx="1"/>
            <rect x="14" y="12" width="7" height="9" rx="1"/>
            <rect x="3" y="16" width="7" height="5" rx="1"/>
          </svg>
          <span class="sidebar-label">Dashboard</span>
        </button>

        <div class="sidebar-divider"></div>
        <div class="sidebar-section-title" data-i18n="sectionTools">Tools</div>
        <button class="sidebar-item" data-page="indicators" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
          </svg>
          <span class="sidebar-label">Indikatoren</span>
        </button>
        <button class="sidebar-item" data-page="gdacs" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
          <span class="sidebar-label">GDACS</span>
        </button>
        <button class="sidebar-item" data-page="ai-mapping" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 2l1.09 3.26L16 6l-2.18 1.74L14.54 11 12 9.27 9.46 11l.72-3.26L8 6l2.91-.74z"/>
            <path d="M5 15l.55 1.63L7 17.18 5.91 18.1l.36 1.63L5 19l-1.27.73.36-1.63L3 17.18l1.45-.55z"/>
            <path d="M19 15l.55 1.63L21 17.18l-1.09.92.36 1.63L19 19l-1.27.73.36-1.63L17 17.18l1.45-.55z"/>
          </svg>
          <span class="sidebar-label">AI Mapping</span>
        </button>

        <div class="sidebar-divider"></div>
        <div class="sidebar-section-title" data-i18n="sectionSources">Quellen &amp; Daten</div>
        <button class="sidebar-item" data-page="aas-data" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <ellipse cx="12" cy="5" rx="9" ry="3"/>
            <path d="M21 12c0 1.66-4.03 3-9 3s-9-1.34-9-3"/>
            <path d="M3 5v14c0 1.66 4.03 3 9 3s9-1.34 9-3V5"/>
          </svg>
          <span class="sidebar-label">AAS Daten</span>
        </button>
        <button class="sidebar-item" data-page="news-feeds" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          <span class="sidebar-label">News Feeds</span>
        </button>
        <button class="sidebar-item" data-page="gdacs-alerts" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="10"/>
            <path d="M10.29 7.86L5.82 15.5a1 1 0 0 0 .86 1.5h8.64a1 1 0 0 0 .86-1.5L11.71 7.86a1 1 0 0 0-1.42 0z"/>
            <line x1="12" y1="10" x2="12" y2="12.5"/>
            <line x1="12" y1="14.5" x2="12.01" y2="14.5"/>
          </svg>
          <span class="sidebar-label">GDACS Alerts</span>
        </button>

        <div class="sidebar-spacer"></div>
        <button class="sidebar-item" data-page="settings" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          <span class="sidebar-label">Einstellungen</span>
        </button>
        <button class="sidebar-item" data-page="docs" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <polyline points="10 9 9 9 8 9"/>
          </svg>
          <span class="sidebar-label">Dokumentation</span>
        </button>
      </nav>
      <div class="sidebar-foot">
        <button id="sidebar-toggle" class="sidebar-toggle-btn" type="button" title="Navigation einklappen">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 6l-6 6 6 6"/></svg>
        </button>
      </div>
    </aside>

    <main id="page-content" class="page-content">
      <!-- Dashboard Page -->
      <section id="page-dashboard" class="page-section active">
        <div class="page-inner">
          <div class="page-header">
            <h2 id="dashboard-title">Resilience Dashboard</h2>
            <p id="dashboard-desc">Übersicht der Resilienz-Tools für deine Lieferkette.</p>
          </div>
          <div class="dashboard-grid" id="dashboard-grid">
            <!-- News tile -->
            <div class="dash-card" id="dash-news">
              <div class="dash-card-header">
                <span class="dash-card-title" id="dash-news-title">Letzte News</span>
                <a href="#" class="dash-card-link" id="dash-news-link" data-nav="news-feeds">Alle anzeigen &rarr;</a>
              </div>
              <div class="dash-card-body" id="dash-news-body">
                <div class="dash-card-empty" id="dash-news-empty">Keine News vorhanden.</div>
              </div>
            </div>
            <!-- GDACS Alerts tile -->
            <div class="dash-card" id="dash-alerts">
              <div class="dash-card-header">
                <span class="dash-card-title" id="dash-alerts-title">GDACS Alerts</span>
                <a href="#" class="dash-card-link" id="dash-alerts-link" data-nav="gdacs-alerts">Alle anzeigen &rarr;</a>
              </div>
              <div class="dash-card-body" id="dash-alerts-body">
                <div class="dash-card-empty" id="dash-alerts-empty">Keine Alerts vorhanden.</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Indicators Page -->
      <section id="page-indicators" class="page-section">
        <div class="page-inner page-inner-wide">
          <div class="page-header">
            <h2 id="indicators-title">Indikatoren</h2>
            <p id="indicators-desc">Definiere Resilienz-Indikatoren für deine Lieferkette.</p>
          </div>

          <!-- List View -->
          <div id="ind-list-view">
            <div class="model-toolbar">
              <div class="model-search-wrap">
                <svg class="model-search-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                <input id="ind-search" class="model-search" type="text" placeholder="Suchen…" />
              </div>
              <span id="ind-count" class="model-count"></span>
              <button id="ind-add-btn" class="btn btn-primary btn-sm-text" type="button">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
                <span id="ind-add-label">Hinzufügen</span>
              </button>
            </div>
            <div class="model-table-wrap">
              <table class="model-table" id="ind-table">
                <thead>
                  <tr>
                    <th id="ind-th-name">Name</th>
                    <th id="ind-th-class">Klasse</th>
                    <th id="ind-th-input">Input</th>
                    <th id="ind-th-rules">Regeln</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="ind-tbody"></tbody>
              </table>
            </div>
            <div id="ind-empty" class="model-empty" hidden>
              <p id="ind-empty-text">Noch keine Indikatoren definiert.</p>
            </div>
          </div>

          <!-- Detail / Edit View -->
          <div id="ind-detail-view" hidden>
            <button id="ind-back-btn" class="news-back-btn" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 18l-6-6 6-6"/></svg>
              <span id="ind-back-label">Zurück</span>
            </button>

            <div class="ind-form">
              <div class="ind-form-grid">
                <div class="ind-field">
                  <label id="ind-name-label" for="ind-name">Name</label>
                  <input id="ind-name" type="text" class="ind-input" placeholder="Indikator-Name" />
                </div>
                <div class="ind-field">
                  <label id="ind-class-label" for="ind-class-select">Klasse</label>
                  <select id="ind-class-select" class="settings-select"></select>
                </div>
                <div class="ind-field">
                  <label id="ind-input-type-label" for="ind-input-type">Input-Typ</label>
                  <select id="ind-input-type" class="settings-select">
                    <option value="number">Zahl</option>
                    <option value="text">Text</option>
                    <option value="boolean">Boolean</option>
                  </select>
                </div>
                <div class="ind-field">
                  <label id="ind-input-label-label" for="ind-input-label">Input-Bezeichnung</label>
                  <input id="ind-input-label" type="text" class="ind-input" placeholder="z.B. Magnitude" />
                </div>
              </div>

              <div class="ind-section">
                <h3 id="ind-groups-title">Regelgruppen</h3>
                <p id="ind-groups-desc" class="ind-section-desc">ODER-verknüpft — erste zutreffende Gruppe bestimmt die Ausgabe.</p>
              </div>
              <div id="ind-groups-container"></div>
              <button id="ind-add-group-btn" class="btn btn-secondary btn-sm-text ind-add-group-btn" type="button">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
                <span id="ind-add-group-label">ODER-Gruppe hinzufügen</span>
              </button>

              <div class="ind-section">
                <h3 id="ind-default-title">Standard-Ausgabe</h3>
                <p id="ind-default-desc" class="ind-section-desc">Wird verwendet wenn keine Gruppe zutrifft.</p>
              </div>
              <div class="ind-default-row">
                <div class="ind-field-sm">
                  <label id="ind-default-label-label">Label</label>
                  <input id="ind-default-label" type="text" class="ind-input" />
                </div>
                <div class="ind-field-sm ind-field-color">
                  <label id="ind-default-color-label">Farbe</label>
                  <input id="ind-default-color" type="color" class="ind-color-input" value="#9ca3af" />
                </div>
                <div class="ind-field-sm">
                  <label id="ind-default-score-label">Score</label>
                  <input id="ind-default-score" type="number" class="ind-input ind-score-input" value="0" />
                </div>
              </div>

              <div id="ind-detail-hint" class="settings-hint" hidden></div>

              <div class="ind-actions">
                <button id="ind-delete-btn" class="btn btn-danger btn-sm" type="button" hidden>
                  <span id="ind-delete-label">Löschen</span>
                </button>
                <div class="settings-actions-spacer"></div>
                <button id="ind-save-btn" class="btn btn-primary" type="button">
                  <span id="ind-save-label">Speichern</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- GDACS Page -->
      <section id="page-gdacs" class="page-section">
        <div class="page-inner">
          <div class="page-header">
            <h2 id="gdacs-title">GDACS</h2>
            <p id="gdacs-desc">Naturkatastrophen-Daten vom <a href="https://www.gdacs.org" target="_blank" rel="noopener" class="inline-link" id="gdacs-link">Global Disaster Alert and Coordination System</a>.</p>
          </div>

          <!-- GDACS Search Card -->
          <div class="settings-card gdacs-search-card">
            <h3 id="gdacs-section-title">GDACS Naturkatastrophen</h3>

            <div class="gdacs-search-row">
              <div class="gdacs-field gdacs-field-country">
                <label id="gdacs-country-label" for="gdacs-country">Land</label>
                <input id="gdacs-country" type="text" class="gdacs-input" placeholder="z.B. Germany, Turkey…" />
              </div>
              <div class="gdacs-field">
                <label id="gdacs-days-label" for="gdacs-days">Zeitraum</label>
                <select id="gdacs-days" class="settings-select">
                  <option value="7">7 Tage</option>
                  <option value="14">14 Tage</option>
                  <option value="30" selected>30 Tage</option>
                  <option value="90">90 Tage</option>
                  <option value="365">1 Jahr</option>
                </select>
              </div>
            </div>

            <div class="gdacs-types" id="gdacs-types">
              <label><input type="checkbox" value="EQ" checked> <span data-gdacs-type="EQ">Erdbeben</span></label>
              <label><input type="checkbox" value="TC" checked> <span data-gdacs-type="TC">Sturm</span></label>
              <label><input type="checkbox" value="FL" checked> <span data-gdacs-type="FL">Flut</span></label>
              <label><input type="checkbox" value="VO" checked> <span data-gdacs-type="VO">Vulkan</span></label>
              <label><input type="checkbox" value="WF" checked> <span data-gdacs-type="WF">Waldbrand</span></label>
              <label><input type="checkbox" value="DR" checked> <span data-gdacs-type="DR">Dürre</span></label>
            </div>

            <div class="gdacs-actions-row">
              <div class="gdacs-field">
                <label id="gdacs-alert-label" for="gdacs-alert">Warnstufe</label>
                <select id="gdacs-alert" class="settings-select">
                  <option value="Green;Orange;Red" id="gdacs-alert-all">Alle</option>
                  <option value="Orange;Red" id="gdacs-alert-orange-red">Orange + Rot</option>
                  <option value="Red" id="gdacs-alert-red">Nur Rot</option>
                </select>
              </div>
              <button id="gdacs-search-btn" class="btn btn-primary btn-sm" type="button">
                <span id="gdacs-search-label">Suchen</span>
              </button>
            </div>
          </div>

          <!-- GDACS Results -->
          <div id="gdacs-results">
            <div id="gdacs-results-count" class="gdacs-results-count" hidden></div>
            <div id="gdacs-table-wrap" hidden>
              <table class="news-table gdacs-table">
                <thead>
                  <tr>
                    <th id="gdacs-th-type" class="gdacs-th-type">Typ</th>
                    <th id="gdacs-th-name">Ereignis</th>
                    <th id="gdacs-th-country">Land</th>
                    <th id="gdacs-th-alert">Warnstufe</th>
                    <th id="gdacs-th-severity" class="gdacs-th-severity">Schwere</th>
                    <th id="gdacs-th-date">Datum</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="gdacs-tbody"></tbody>
              </table>
            </div>
            <div id="gdacs-empty" class="news-empty" hidden>
              <p id="gdacs-empty-text">Keine Ereignisse gefunden.</p>
            </div>
            <div id="gdacs-error" class="settings-hint hint-error" hidden></div>
            <div id="gdacs-skeleton" hidden></div>
          </div>
        </div>
      </section>

      <!-- AI Mapping Page -->
      <section id="page-ai-mapping" class="page-section">
        <div class="page-inner">
          <div class="page-header">
            <h2 id="ai-mapping-title">AI Mapping</h2>
            <p id="ai-mapping-desc">KI-gestützte Zuordnung und Analyse.</p>
          </div>
        </div>
      </section>

      <!-- AAS Data Page -->
      <section id="page-aas-data" class="page-section">
        <div class="page-inner page-inner-wider">
          <div class="page-header">
            <h2 id="aas-data-title">AAS Daten</h2>
            <p id="aas-data-desc">Verwaltungsschalen-Daten zu Lieferanten, Produkten und Materialien.</p>
          </div>

          <div class="docs-layout">
            <!-- Internal Navigation -->
            <nav class="docs-nav" id="aas-data-nav">
              <button class="docs-nav-item active" data-aas-nav="overview" id="aas-nav-btn-overview" type="button">Übersicht</button>
              <button class="docs-nav-item" data-aas-nav="sources" id="aas-nav-btn-sources" type="button">Quellen</button>
              <button class="docs-nav-item" data-aas-nav="groups" id="aas-nav-btn-groups" type="button">Gruppen</button>
              <button class="docs-nav-item" data-aas-nav="assign" id="aas-nav-btn-assign" type="button">Zuordnung</button>
            </nav>

            <div class="aas-data-content">
              <!-- ═══ Overview Section ═══ -->
              <div id="aas-nav-overview">
                <!-- Overview List -->
                <div id="aas-overview-list">
                  <div class="model-toolbar">
                    <div class="model-search-wrap">
                      <svg class="model-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                      <input id="aas-ov-search" class="model-search" type="text" placeholder="Suchen…" data-i18n-placeholder="aasOvSearch" />
                    </div>
                    <button id="aas-ov-import-btn" class="aas-import-btn" type="button">
                      <svg viewBox="0 0 24 24" width="15" height="15" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                      <span id="aas-ov-import-label">Import</span>
                    </button>
                    <span id="aas-ov-count" class="model-count"></span>
                  </div>
                  <div class="model-table-wrap">
                    <table class="model-table" id="aas-ov-table">
                      <thead>
                        <tr>
                          <th id="aas-ov-th-aasid">AAS ID</th>
                          <th></th>
                          <th id="aas-ov-th-source">Quelle</th>
                          <th id="aas-ov-th-group">Gruppe</th>
                          <th id="aas-ov-th-imported">Letzter Import</th>
                          <th></th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody id="aas-ov-tbody"></tbody>
                    </table>
                  </div>
                  <div id="aas-ov-empty" class="model-empty">Keine AAS IDs vorhanden. Füge Quellen und IDs hinzu.</div>
                  <div id="aas-ov-pagination" class="news-pagination"></div>
                </div>

                <!-- Overview Detail (Shell + Submodels) -->
                <div id="aas-overview-detail" hidden>
                  <button id="aas-ov-back-btn" class="news-back-btn" type="button">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
                    <span id="aas-ov-back-label">Zurück</span>
                  </button>

                  <!-- Progress Bar -->
                  <div class="aas-progress" id="aas-progress" hidden>
                    <div class="aas-progress-track"><div class="aas-progress-bar" id="aas-progress-bar"></div></div>
                    <span class="aas-progress-text" id="aas-progress-text">0/0</span>
                  </div>

                  <!-- Shell Info -->
                  <div id="aas-shell-info" class="aas-shell-card"></div>

                  <!-- Submodels Container -->
                  <div id="aas-submodels-container"></div>
                </div>
              </div>

              <!-- ═══ Sources Section ═══ -->
              <div id="aas-nav-sources" hidden>
                <!-- List View -->
                <div id="src-list-view">
                  <div class="model-toolbar">
                    <div class="model-search-wrap">
                      <svg class="model-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                      <input id="src-search" class="model-search" type="text" placeholder="Suchen…" data-i18n-placeholder="srcSearch" />
                    </div>
                    <span id="src-count" class="model-count"></span>
                    <button id="src-add-btn" class="btn btn-primary btn-sm-text" type="button">
                      <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                      <span id="src-add-label">Hinzufügen</span>
                    </button>
                  </div>
                  <div class="model-table-wrap">
                    <table class="model-table" id="src-table">
                      <thead>
                        <tr>
                          <th id="src-th-name">Name</th>
                          <th id="src-th-url">Basis-URL</th>
                          <th id="src-th-ids">IDs</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody id="src-tbody"></tbody>
                    </table>
                  </div>
                  <div id="src-empty" class="model-empty">Noch keine Quellen definiert.</div>
                  <div id="src-pagination" class="news-pagination"></div>
                </div>

                <!-- Detail / Edit View -->
                <div id="src-detail-view" hidden>
                  <button id="src-back-btn" class="news-back-btn" type="button">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
                    <span id="src-back-label">Zurück</span>
                  </button>

                  <div class="src-form">
                    <div class="src-form-grid">
                      <div class="ind-field">
                        <label id="src-lbl-name" for="src-name">Name</label>
                        <input id="src-name" class="ind-input" type="text" />
                      </div>
                      <div class="ind-field">
                        <label id="src-lbl-url" for="src-url">Basis-URL</label>
                        <input id="src-url" class="ind-input" type="url" placeholder="https://aas-server.example.com/api/v3.0" />
                      </div>
                    </div>

                    <!-- IDs Section with Tabs (hidden until source is saved) -->
                    <div id="src-ids-section" class="src-section" hidden>
                      <div class="src-tabs">
                        <button class="src-tab active" data-tab="all" id="src-tab-all">Alle</button>
                        <button class="src-tab" data-tab="aas" id="src-tab-aas">AAS IDs</button>
                        <button class="src-tab" data-tab="item" id="src-tab-item">Item IDs</button>
                      </div>
                      <div class="model-search-wrap" style="margin:0.5rem 0">
                        <svg class="model-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                        <input id="src-id-search" class="model-search" type="text" placeholder="Suchen…" data-i18n-placeholder="srcIdSearch" />
                      </div>

                      <!-- Tab: Alle -->
                      <div class="src-tab-content active" id="src-tab-content-all">
                        <ul id="src-id-list-all" class="src-id-list"></ul>
                        <div id="src-id-empty-all" class="src-id-empty">Noch keine IDs hinzugefügt.</div>
                        <div id="src-id-pag-all" class="news-pagination"></div>
                        <button id="src-delete-all-ids-btn" class="btn btn-danger btn-sm-text" type="button" hidden>
                          <svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
                          <span id="src-delete-all-ids-label">Alle löschen</span>
                        </button>
                      </div>

                      <!-- Tab: AAS IDs -->
                      <div class="src-tab-content" id="src-tab-content-aas">
                        <div class="src-id-add-row">
                          <input id="src-aas-input" class="ind-input" type="text" placeholder="https://example.com/aas/Pump-001" />
                          <button id="src-aas-add-btn" class="btn btn-primary btn-sm-text" type="button">
                            <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                            <span id="src-aas-add-label">Hinzufügen</span>
                          </button>
                        </div>
                        <ul id="src-id-list-aas" class="src-id-list"></ul>
                        <div id="src-id-empty-aas" class="src-id-empty">Noch keine AAS IDs hinzugefügt.</div>
                        <div id="src-id-pag-aas" class="news-pagination"></div>
                      </div>

                      <!-- Tab: Item IDs -->
                      <div class="src-tab-content" id="src-tab-content-item">
                        <div class="ind-field" style="margin-bottom: 0.5rem;">
                          <label id="src-prefix-label" for="src-prefix-input">Prefix</label>
                          <input id="src-prefix-input" class="ind-input" type="text" placeholder="https://example.com/aas/" />
                        </div>
                        <div class="src-id-add-row">
                          <input id="src-item-input" class="ind-input" type="text" placeholder="Pump-001" />
                          <button id="src-item-add-btn" class="btn btn-primary btn-sm-text" type="button">
                            <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                            <span id="src-item-add-label">Hinzufügen</span>
                          </button>
                        </div>
                        <div class="src-id-add-row" style="margin-top: 0.4rem;">
                          <input id="src-import-url" class="ind-input" type="url" placeholder="https://api.example.com/item-ids" />
                          <button id="src-import-btn" class="btn btn-secondary btn-sm-text" type="button">
                            <svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            <span id="src-import-label">Importieren</span>
                          </button>
                        </div>
                        <ul id="src-id-list-item" class="src-id-list"></ul>
                        <div id="src-id-empty-item" class="src-id-empty">Noch keine Item IDs hinzugefügt.</div>
                        <div id="src-id-pag-item" class="news-pagination"></div>
                      </div>

                      <div id="src-id-hint" class="settings-hint" hidden></div>
                    </div>

                    <!-- Available Endpoints (collapsible) -->
                    <div id="src-endpoints-section" class="src-section" hidden>
                      <button class="src-collapsible-header" id="src-endpoints-toggle" type="button">
                        <span id="src-endpoints-title">Verfügbare Endpunkte</span>
                        <svg class="src-collapsible-icon" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
                      </button>
                      <div class="src-collapsible-body" id="src-endpoints-body" hidden>
                        <ul class="src-endpoint-list">
                          <li><code>getShell</code> <span class="src-ep-params">(aasId)</span></li>
                          <li><code>getAssetInformation</code> <span class="src-ep-params">(aasId)</span></li>
                          <li><code>getSubmodelRefs</code> <span class="src-ep-params">(aasId)</span></li>
                          <li><code>getSubmodel</code> <span class="src-ep-params">(aasId, submodelId)</span></li>
                          <li><code>getSubmodelElement</code> <span class="src-ep-params">(submodelId, idShortPath)</span></li>
                          <li><code>getThumbnail</code> <span class="src-ep-params">(aasId)</span></li>
                          <li><code>getAttachment</code> <span class="src-ep-params">(submodelId, idShortPath)</span></li>
                        </ul>
                      </div>
                    </div>

                    <!-- Actions -->
                    <div class="ind-actions">
                      <button id="src-delete-btn" class="btn btn-danger" type="button" hidden>Löschen</button>
                      <button id="src-save-btn" class="btn btn-primary" type="button">Speichern</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- ═══ Gruppen (simple CRUD) ═══ -->
              <div id="aas-nav-groups" hidden>
                <!-- List -->
                <div id="grp-list-view">
                  <div class="model-toolbar">
                    <div class="model-search-wrap">
                      <svg class="model-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                      <input id="grp-search" class="model-search" type="text" placeholder="Gruppen suchen…" />
                    </div>
                    <span id="grp-count" class="model-count"></span>
                    <button id="grp-add-btn" class="btn btn-primary btn-sm-text" type="button">
                      <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                      <span id="grp-add-label">Hinzufügen</span>
                    </button>
                  </div>
                  <div class="model-table-wrap">
                    <table class="model-table">
                      <thead><tr><th id="grp-th-name">Name</th><th id="grp-th-count">AAS IDs</th><th></th></tr></thead>
                      <tbody id="grp-tbody"></tbody>
                    </table>
                  </div>
                  <div id="grp-empty" class="news-empty" hidden><p id="grp-empty-text">Noch keine Gruppen vorhanden.</p></div>
                  <div id="grp-pagination" class="news-pagination"></div>
                </div>
                <!-- Detail -->
                <div id="grp-detail-view" hidden>
                  <button id="grp-back-btn" class="btn btn-ghost btn-sm-text" type="button" style="margin-bottom:0.75rem">
                    <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><polyline points="15 18 9 12 15 6"/></svg>
                    <span id="grp-back-label">Zurück</span>
                  </button>
                  <div class="ind-field" style="margin-bottom:1rem">
                    <label id="grp-name-label" for="grp-name-input">Name</label>
                    <input id="grp-name-input" class="ind-input" type="text" />
                  </div>
                  <div id="grp-hint" class="settings-hint" hidden></div>
                  <div class="grp-actions">
                    <button id="grp-save-btn" class="btn btn-primary btn-sm-text" type="button">
                      <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                      <span id="grp-save-label">Speichern</span>
                    </button>
                    <button id="grp-delete-btn" class="btn btn-danger btn-sm-text" type="button" hidden>
                      <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
                      <span id="grp-delete-label">Löschen</span>
                    </button>
                  </div>
                </div>
              </div>

              <!-- ═══ Zuordnung (group picker + dual panel) ═══ -->
              <div id="aas-nav-assign" hidden>
                <div class="ind-field" style="margin-bottom:1rem">
                  <label id="assign-grp-label">Gruppe</label>
                  <select id="assign-grp-select" class="ind-input"></select>
                </div>
                <div id="assign-hint" class="settings-hint" hidden></div>

                <div id="assign-content" hidden>
                  <div class="grp-assign">
                    <!-- ── Available panel ── -->
                    <div class="grp-assign-panel">
                      <div class="grp-panel-header">
                        <div class="grp-panel-title" id="grp-avail-title">Verfügbar</div>
                        <select id="grp-source-filter" class="ind-input grp-source-select"></select>
                        <div class="model-search-wrap">
                          <svg class="model-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                          <input id="grp-avail-search" class="model-search" type="text" placeholder="Verfügbare suchen…" />
                        </div>
                      </div>
                      <div class="grp-panel-main">
                        <ul id="grp-avail-list" class="grp-id-list"></ul>
                        <div id="grp-avail-empty" class="grp-panel-empty" hidden>Keine verfügbaren AAS IDs.</div>
                      </div>
                      <div class="grp-panel-footer">
                        <button id="grp-add-all-btn" class="btn btn-secondary btn-sm-text" type="button">
                          <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><polyline points="13 17 18 12 13 7"/><polyline points="6 17 11 12 6 7"/></svg>
                          <span id="grp-add-all-label">Alle hinzufügen</span>
                        </button>
                        <div id="grp-avail-pag" class="news-pagination" style="margin:0"></div>
                      </div>
                    </div>
                    <!-- ── Assigned panel ── -->
                    <div class="grp-assign-panel">
                      <div class="grp-panel-header">
                        <div class="grp-panel-title" id="grp-assigned-title">Zugeordnet</div>
                        <div class="model-search-wrap">
                          <svg class="model-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                          <input id="grp-assigned-search" class="model-search" type="text" placeholder="Zugeordnete suchen…" />
                        </div>
                      </div>
                      <div class="grp-panel-main">
                        <ul id="grp-assigned-list" class="grp-id-list"></ul>
                        <div id="grp-assigned-empty" class="grp-panel-empty" hidden>Keine AAS IDs zugeordnet.</div>
                      </div>
                      <div class="grp-panel-footer">
                        <button id="grp-remove-all-btn" class="btn btn-danger btn-sm-text" type="button">
                          <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
                          <span id="grp-remove-all-label">Alle entfernen</span>
                        </button>
                        <div id="grp-assigned-pag" class="news-pagination" style="margin:0"></div>
                      </div>
                    </div>
                  </div>

                  <div class="grp-actions">
                    <button id="assign-save-btn" class="btn btn-primary btn-sm-text" type="button">
                      <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                      <span id="assign-save-label">Speichern</span>
                    </button>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </section>

      <!-- News Feeds Page -->
      <section id="page-news-feeds" class="page-section">
        <div class="page-inner">
          <div class="page-header">
            <div class="page-header-row">
              <div>
                <h2 id="news-feeds-title">News Feeds</h2>
                <p id="news-feeds-desc">Externe Nachrichten und Informationsquellen.</p>
              </div>
              <button id="news-refresh-btn" class="btn btn-secondary btn-sm" type="button">
                <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                <span id="news-refresh-label">Aktualisieren</span>
              </button>
            </div>
          </div>
          <!-- List View -->
          <div id="news-list-view">
            <div id="news-table-wrap">
              <table class="news-table" id="news-table">
                <thead>
                  <tr>
                    <th class="news-th-id" id="news-th-id">ID</th>
                    <th id="news-th-title">Titel</th>
                    <th id="news-th-stored">Gespeichert</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody id="news-tbody"></tbody>
              </table>
              <div id="news-empty" class="news-empty" hidden>
                <p id="news-empty-text">Keine News vorhanden. Füge Feeds in den Einstellungen hinzu.</p>
              </div>
            </div>
            <div id="news-pagination" class="news-pagination"></div>
          </div>

          <!-- Detail View -->
          <div id="news-detail-view" class="news-detail" hidden>
            <button id="news-back-btn" class="news-back-btn" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 18l-6-6 6-6"/></svg>
              <span id="news-back-label">Zurück</span>
            </button>
            <div id="news-detail-content" class="news-detail-body"></div>
          </div>
        </div>
      </section>

      <!-- GDACS Alerts Page -->
      <section id="page-gdacs-alerts" class="page-section">
        <div class="page-inner">
          <div class="page-header">
            <div class="page-header-row">
              <div>
                <h2 id="gdacs-alerts-title">GDACS Alerts</h2>
                <p id="gdacs-alerts-desc">Gespeicherte Naturkatastrophen-Meldungen für deine überwachten Länder.</p>
              </div>
              <button id="alerts-refresh-btn" class="btn btn-secondary btn-sm" type="button">
                <svg class="btn-icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                <span id="alerts-refresh-label">Aktualisieren</span>
              </button>
            </div>
          </div>
          <div id="alerts-content"></div>
          <div id="alerts-empty" class="news-empty" hidden>
            <p id="alerts-empty-text">Keine Alerts vorhanden. Füge Länder in den Einstellungen hinzu.</p>
          </div>
          <div id="alerts-pagination" class="news-pagination"></div>
        </div>
      </section>

      <!-- Settings Page -->
      <section id="page-settings" class="page-section">
        <div class="page-inner">
          <div class="page-header">
            <h2 id="settings-title">Einstellungen</h2>
            <p id="settings-desc">Konfiguriere die Resilience-App.</p>
          </div>

          <!-- News Feeds Settings Card -->
          <div class="settings-card">
            <h3 id="feed-section-title">News Feeds</h3>

            <div class="feed-add-row">
              <input id="feed-url-input" class="feed-url-input" type="url" placeholder="Feed-URL eingeben…" />
              <button id="feed-add-btn" class="btn btn-primary btn-sm" type="button">
                <span id="feed-add-label">Hinzufügen</span>
              </button>
            </div>
            <div id="feed-hint" class="settings-hint" hidden></div>

            <div id="feed-list" class="feed-list"></div>
            <div id="feed-list-empty" class="feed-list-empty" hidden>
              <span id="feed-empty-label">Noch keine Feeds konfiguriert.</span>
            </div>

            <div class="settings-row">
              <label id="retention-label" for="retention-select">Aufbewahrung</label>
              <select id="retention-select" class="settings-select">
                <option value="7">7 Tage</option>
                <option value="14">14 Tage</option>
                <option value="30" selected>30 Tage</option>
                <option value="60">60 Tage</option>
                <option value="90">90 Tage</option>
              </select>
            </div>

            <div class="settings-row">
              <label id="refresh-label" for="refresh-select">Abruf-Intervall</label>
              <select id="refresh-select" class="settings-select">
                <option value="15">15 Min.</option>
                <option value="30">30 Min.</option>
                <option value="60" selected>1 Std.</option>
                <option value="360">6 Std.</option>
                <option value="1440">24 Std.</option>
              </select>
            </div>

            <div class="settings-actions">
              <button id="feed-purge-btn" class="btn btn-danger btn-sm" type="button">
                <span id="feed-purge-label">Alle News löschen</span>
              </button>
              <div class="settings-actions-spacer"></div>
              <button id="settings-save-btn" class="btn btn-primary" type="button">
                <span id="settings-save-label">Speichern</span>
              </button>
            </div>
          </div>

          <!-- GDACS Country Watchlist Card -->
          <div class="settings-card">
            <h3 id="gdacs-settings-title">GDACS Länderüberwachung</h3>

            <div class="feed-add-row">
              <input id="gdacs-country-input" class="feed-url-input" type="text" placeholder="Land eingeben…" />
              <button id="gdacs-country-add-btn" class="btn btn-primary btn-sm" type="button">
                <span id="gdacs-country-add-label">Hinzufügen</span>
              </button>
            </div>
            <div id="gdacs-country-hint" class="settings-hint" hidden></div>

            <div id="gdacs-country-list" class="feed-list"></div>
            <div id="gdacs-country-list-empty" class="feed-list-empty" hidden>
              <span id="gdacs-country-empty-label">Noch keine Länder konfiguriert.</span>
            </div>

            <div class="settings-row">
              <label id="gdacs-retention-label" for="gdacs-retention-select">Aufbewahrung</label>
              <select id="gdacs-retention-select" class="settings-select">
                <option value="7">7 Tage</option>
                <option value="14">14 Tage</option>
                <option value="30" selected>30 Tage</option>
                <option value="60">60 Tage</option>
                <option value="90">90 Tage</option>
              </select>
            </div>

            <div class="settings-row">
              <label id="gdacs-refresh-label" for="gdacs-refresh-select">Abruf-Intervall</label>
              <select id="gdacs-refresh-select" class="settings-select">
                <option value="15">15 Min.</option>
                <option value="30">30 Min.</option>
                <option value="60" selected>1 Std.</option>
                <option value="360">6 Std.</option>
                <option value="1440">24 Std.</option>
              </select>
            </div>

            <div class="settings-actions">
              <button id="gdacs-purge-btn" class="btn btn-danger btn-sm" type="button">
                <span id="gdacs-purge-label">Alle Alerts löschen</span>
              </button>
              <div class="settings-actions-spacer"></div>
              <button id="gdacs-settings-save-btn" class="btn btn-primary" type="button">
                <span id="gdacs-settings-save-label">Speichern</span>
              </button>
            </div>
          </div>

          <!-- AAS Import Settings Card -->
          <div class="settings-card">
            <h3 id="import-settings-title">AAS Import</h3>
            <div class="settings-row">
              <label id="import-interval-label" for="import-interval-select">Auto-Import Intervall</label>
              <select id="import-interval-select" class="settings-select">
                <option value="0">Aus</option>
                <option value="6">6 Std.</option>
                <option value="12">12 Std.</option>
                <option value="24">24 Std.</option>
              </select>
            </div>
            <div class="settings-actions">
              <div class="settings-actions-spacer"></div>
              <button id="import-settings-save-btn" class="btn btn-primary" type="button">
                <span id="import-settings-save-label">Speichern</span>
              </button>
            </div>
          </div>

          <!-- Indicator Classes Settings Card -->
          <div class="settings-card">
            <h3 id="ind-classes-title">Indikator-Klassen</h3>

            <div class="feed-add-row">
              <input id="ind-class-input" class="feed-url-input" type="text" placeholder="Klasse eingeben…" />
              <button id="ind-class-add-btn" class="btn btn-primary btn-sm" type="button">
                <span id="ind-class-add-label">Hinzufügen</span>
              </button>
            </div>
            <div id="ind-class-hint" class="settings-hint" hidden></div>

            <div id="ind-class-list" class="feed-list"></div>
            <div id="ind-class-list-empty" class="feed-list-empty" hidden>
              <span id="ind-class-empty-label">Noch keine Klassen definiert.</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Docs Page -->
      <section id="page-docs" class="page-section">
        <div class="page-inner page-inner-wide">
          <div class="page-header">
            <h2 id="docs-title">Dokumentation</h2>
            <p id="docs-desc">Anleitungen und Informationen zu den Resilienz-Tools.</p>
          </div>
          <div class="docs-layout">
            <nav class="docs-nav" id="docs-nav">
              <button class="docs-nav-item active" data-doc="overview" type="button">Übersicht</button>
              <button class="docs-nav-item" data-doc="indicators" type="button">Indikatoren</button>
              <button class="docs-nav-item" data-doc="news-feeds" type="button">News Feeds</button>
              <button class="docs-nav-item" data-doc="gdacs-search" type="button">GDACS Suche</button>
              <button class="docs-nav-item" data-doc="gdacs-alerts" type="button">GDACS Alerts</button>
              <button class="docs-nav-item" data-doc="dashboard" type="button">Dashboard</button>
              <button class="docs-nav-item" data-doc="settings" type="button">Einstellungen</button>
            </nav>
            <div class="docs-content" id="docs-content"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="/apps/resilience/app.js?v=13"></script>
</body>
</html>
