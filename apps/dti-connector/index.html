<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DTI Connector – Workspace</title>
  <link rel="stylesheet" href="/apps/dti-connector/styles.css" />
  <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header class="app-header">
    <a href="/dashboard" class="header-back-btn" title="Zurück zum Dashboard">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 18l-6-6 6-6"/></svg>
    </a>
    <div class="brand">
      <svg class="brand-icon" viewBox="0 0 24 24">
        <path d="M4 6h6M4 12h6M4 18h6" />
        <path d="M14 6h6M14 12h6M14 18h6" />
        <path d="M10 6l4 6-4 6" />
      </svg>
      <span id="brand-text">DTI Connector</span>
    </div>
    <div class="header-spacer"></div>
    <a id="docs-link" href="/apps/dti-connector/docs" class="header-swagger-btn" target="_blank" title="API Docs" style="display:none">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      <span id="swagger-btn-label">API Docs</span>
    </a>
    <div class="user-menu-wrap">
      <button id="user-menu-toggle" class="user-avatar-btn" type="button" aria-haspopup="true" aria-expanded="false">
        <span id="user-initials">--</span>
      </button>
      <div id="user-menu" class="user-menu" hidden>
        <div id="user-info" class="user-menu-info"></div>
        <div class="user-menu-section">
          <div class="locale-switch" role="radiogroup" aria-label="Sprache">
            <button id="locale-de-btn" class="locale-switch-btn active" type="button" role="radio" aria-checked="true">DE</button>
            <button id="locale-en-btn" class="locale-switch-btn" type="button" role="radio" aria-checked="false">EN</button>
          </div>
        </div>
        <button id="logout-btn" class="user-menu-item" type="button">Logout</button>
      </div>
    </div>
  </header>

  <!-- Connector List View -->
  <div id="connector-list-view" class="connector-list-container">
    <div class="connector-list-inner">
      <div class="page-header">
        <h2 id="connector-list-title">Konnektoren</h2>
      </div>
      <div class="connector-toolbar">
        <button id="connector-add-btn" class="btn btn-secondary btn-sm-text" type="button">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
          <span id="connector-add-label">Neuer Connector</span>
        </button>
      </div>
      <div id="connector-grid" class="connector-grid"></div>
      <div id="connector-hint" class="hierarchy-hint" hidden></div>
    </div>
  </div>

  <!-- Connector Detail View -->
  <div id="connector-detail-view" class="app-layout" style="display:none">
    <aside id="sidebar" class="sidebar" aria-label="Navigation">
      <nav id="sidebar-nav" class="sidebar-nav">
        <button class="sidebar-item active" data-page="hierarchy" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 3h7v7H3zM14 3h7v7h-7zM3 14h7v7H3zM14 14h7v7h-7z"/>
          </svg>
          <span class="sidebar-label">Hierarchie</span>
        </button>
        <button class="sidebar-item" data-page="model" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
          </svg>
          <span class="sidebar-label">Modell</span>
        </button>
        <button class="sidebar-item" data-page="files" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
          <span class="sidebar-label">Dateien</span>
        </button>
        <button class="sidebar-item" data-page="assets" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M20 7h-4V3H8v4H4a2 2 0 0 0-2 2v11h20V9a2 2 0 0 0-2-2z"/>
          </svg>
          <span class="sidebar-label">Assets</span>
        </button>
        <div class="sidebar-spacer"></div>
        <button id="sidebar-share-btn" class="sidebar-item" type="button" title="Teilen" style="display:none">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
          </svg>
          <span class="sidebar-label">Teilen</span>
        </button>
        <button id="sidebar-members-btn" class="sidebar-item" type="button" title="Mitglieder" style="display:none">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
          <span class="sidebar-label">Mitglieder</span>
        </button>
        <button class="sidebar-item" data-page="settings" type="button">
          <svg class="sidebar-icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          <span class="sidebar-label">Einstellungen</span>
        </button>
      </nav>
      <div class="sidebar-foot">
        <button id="sidebar-toggle" class="sidebar-toggle-btn" type="button" title="Navigation einklappen">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M14 6l-6 6 6 6"/></svg>
        </button>
      </div>
    </aside>

    <main id="page-content" class="page-content">
      <!-- Hierarchy Page -->
      <section id="page-hierarchy" class="page-section active">
        <div class="page-inner">
          <div class="page-header">
            <h2 id="hierarchy-title">Hierarchie-Level</h2>
            <p id="hierarchy-desc">Definiere die Ebenen der Produkthierarchie.</p>
            <div class="allowed-chars-box" id="hierarchy-chars-box">
              <span id="hierarchy-chars-label">Erlaubte Zeichen:</span>
              <code>A-Z a-z 0-9 _ -</code>
            </div>
          </div>
          <div id="hierarchy-list" class="hierarchy-list"></div>
          <div class="hierarchy-actions">
            <button id="hierarchy-add-btn" class="btn btn-secondary" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
              <span id="hierarchy-add-label">Level hinzufügen</span>
            </button>
            <button id="hierarchy-import-btn" class="btn-icon" type="button" title="Import">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            </button>
            <input id="hierarchy-import-file" type="file" accept=".xlsx,.csv" hidden />
            <button id="hierarchy-export-btn" class="btn-icon" type="button" title="Export">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </button>
            <button id="hierarchy-save-btn" class="btn btn-primary" type="button">
              <span id="hierarchy-save-label">Übernehmen</span>
            </button>
          </div>
          <div id="hierarchy-hint" class="hierarchy-hint" hidden></div>
        </div>
      </section>

      <!-- Model Page -->
      <section id="page-model" class="page-section">
        <div class="page-inner page-inner-wide">
          <div class="page-header">
            <h2 id="model-title">Datenmodell</h2>
            <p id="model-desc">Definiere die Datenpunkte, die der Connector bereitstellt. Jeder Datenpunkt hat eine eindeutige ID, einen optionalen Namen und einen Typ.</p>
          </div>

          <div class="model-toolbar">
            <div class="model-search-wrap">
              <svg class="model-search-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
              <input id="model-search" class="model-search" type="text" placeholder="Suchen…" />
            </div>
            <span id="model-count" class="model-count"></span>
            <button id="model-delete-selected-btn" class="btn btn-danger btn-sm-text model-bulk-del" type="button" hidden>
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
              <span id="model-delete-selected-label">Auswahl löschen</span>
              <span id="model-delete-selected-count" class="model-bulk-count"></span>
            </button>
            <button id="model-add-btn" class="btn btn-secondary btn-sm-text" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
              <span id="model-add-label">Hinzufügen</span>
            </button>
          </div>

          <div class="model-table-wrap">
            <div class="model-table-header">
              <span class="model-col-check"><input type="checkbox" id="model-select-all" class="model-checkbox" /></span>
              <span class="model-col-num">#</span>
              <span class="model-col-id">ID</span>
              <span class="model-col-name">Name</span>
              <span class="model-col-type">Typ</span>
              <span class="model-col-del"></span>
            </div>
            <div id="model-table-body" class="model-table-body"></div>
          </div>

          <div class="model-actions">
            <button id="model-import-btn" class="btn-icon" type="button" title="Import">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            </button>
            <input id="model-import-file" type="file" accept=".xlsx,.csv" hidden />
            <button id="model-export-btn" class="btn-icon" type="button" title="Export">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </button>
            <button id="model-save-btn" class="btn btn-primary" type="button">
              <span id="model-save-label">Übernehmen</span>
            </button>
          </div>
          <div id="model-hint" class="hierarchy-hint" hidden></div>
        </div>
      </section>
      <!-- Files Page -->
      <section id="page-files" class="page-section">
        <div class="page-inner page-inner-wide">
          <div class="page-header">
            <h2 id="files-title">Dateien</h2>
            <p id="files-desc">Lade Dateien hoch und verknüpfe sie mit einer eindeutigen ID. Die Dateien werden sofort gespeichert.</p>
          </div>

          <div class="model-toolbar">
            <div class="model-search-wrap">
              <svg class="model-search-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
              <input id="files-search" class="model-search" type="text" placeholder="Suchen…" />
            </div>
            <span id="files-count" class="model-count"></span>
            <button id="files-import-btn" class="btn-icon" type="button" title="Import ZIP">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            </button>
            <input id="files-import-file" type="file" accept=".zip" hidden />
            <button id="files-export-btn" class="btn-icon" type="button" title="Export ZIP">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </button>
            <button id="files-add-btn" class="btn btn-secondary btn-sm-text" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
              <span id="files-add-label">Hinzufügen</span>
            </button>
          </div>

          <div class="model-table-wrap">
            <div class="files-table-header">
              <span class="files-col-num">#</span>
              <span class="files-col-id">ID</span>
              <span class="files-col-lang">EN</span>
              <span class="files-col-lang">DE</span>
              <span class="files-col-del"></span>
            </div>
            <div id="files-table-body" class="model-table-body"></div>
          </div>

          <div id="files-hint" class="hierarchy-hint" hidden></div>
        </div>
      </section>

      <section id="page-assets" class="page-section">
        <!-- List View -->
        <div id="assets-list-view" class="page-inner page-inner-wide">
          <div class="page-header">
            <h2 id="assets-title">Assets</h2>
            <p id="assets-desc">Verwalte deine Assets. Jedes Asset erhält eine eindeutige Item ID.</p>
            <div class="allowed-chars-box" id="assets-chars-box">
              <span id="assets-chars-label">Erlaubte Zeichen:</span>
              <code>A-Z a-z 0-9</code>
            </div>
          </div>

          <div class="model-toolbar">
            <div class="model-search-wrap">
              <svg class="model-search-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
              <input id="assets-search" class="model-search" type="text" placeholder="Suchen…" />
            </div>
            <span id="assets-count" class="model-count"></span>
            <button id="assets-delete-selected-btn" class="btn btn-danger btn-sm-text model-bulk-del" type="button" hidden>
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
              <span id="assets-delete-selected-label">Auswahl löschen</span>
              <span id="assets-delete-selected-count" class="model-bulk-count"></span>
            </button>
            <button id="assets-add-btn" class="btn btn-secondary btn-sm-text" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"/></svg>
              <span id="assets-add-label">Hinzufügen</span>
            </button>
          </div>

          <div class="model-table-wrap">
            <div class="assets-table-header">
              <span class="model-col-check"><input type="checkbox" id="assets-select-all" class="model-checkbox" /></span>
              <span class="assets-col-num">#</span>
              <span class="assets-col-id" id="assets-col-id-label">Item ID</span>
              <span class="assets-col-del"></span>
            </div>
            <div id="assets-table-body" class="model-table-body"></div>
          </div>

          <div class="assets-actions">
            <button id="assets-import-btn" class="btn-icon" type="button" title="Import">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            </button>
            <input id="assets-import-file" type="file" accept=".xlsx,.csv" hidden />
            <button id="assets-export-btn" class="btn-icon" type="button" title="Export">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </button>
          </div>

          <div id="assets-list-hint" class="hierarchy-hint" hidden></div>
        </div>

        <!-- Detail View -->
        <div id="assets-detail-view" class="page-inner page-inner-wide" style="display:none">
          <div class="assets-detail-header">
            <button id="assets-back-btn" class="btn btn-secondary btn-sm-text" type="button">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 18l-6-6 6-6"/></svg>
              <span id="assets-back-label">Zurück</span>
            </button>
            <label id="assets-detail-id-label" class="assets-detail-id-label">Item ID</label>
            <input id="assets-detail-id" class="assets-detail-id-input" type="text" />
          </div>

          <div id="assets-hierarchy-section">
            <h3 id="assets-hierarchy-section-title" class="assets-section-title">Hierarchie</h3>
            <div id="assets-hierarchy-fields" class="assets-fields"></div>
          </div>

          <div id="assets-props-section">
            <h3 id="assets-props-section-title" class="assets-section-title">Eigenschaften</h3>
            <div class="model-toolbar">
              <div class="model-search-wrap">
                <svg class="model-search-icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                <input id="assets-props-search" class="model-search" type="text" placeholder="Suchen…" />
              </div>
              <span id="assets-props-count" class="model-count"></span>
            </div>
            <div class="model-table-wrap">
              <div class="assets-props-table-header">
                <span>#</span>
                <span id="assets-props-col-id">ID</span>
                <span>EN</span>
                <span>DE</span>
              </div>
              <div id="assets-props-body" class="model-table-body"></div>
            </div>
          </div>

          <div id="assets-files-section">
            <h3 id="assets-files-section-title" class="assets-section-title">Dateien</h3>
            <div class="model-table-wrap">
              <div class="assets-files-table-header">
                <span>#</span>
                <span id="assets-files-col-id">ID</span>
                <span>File</span>
              </div>
              <div id="assets-files-body" class="model-table-body"></div>
            </div>
          </div>

          <div class="model-actions">
            <button id="assets-save-btn" class="btn btn-primary" type="button">
              <span id="assets-save-label">Übernehmen</span>
            </button>
          </div>
          <div id="assets-detail-hint" class="hierarchy-hint" hidden></div>
        </div>
      </section>

      <!-- Settings Page -->
      <section id="page-settings" class="page-section">
        <div class="page-inner">
          <div class="page-header">
            <h2 id="settings-title">Einstellungen</h2>
            <p id="settings-desc">Verwalte deinen API-Schlüssel für den Zugriff auf die DTI Connector API.</p>
          </div>

          <div class="settings-card">
            <h3 id="settings-apikey-title">API-Schlüssel</h3>
            <p id="settings-apikey-desc" class="settings-card-desc">Dein persönlicher Schlüssel wird als Teil der API-URL verwendet. Ohne Schlüssel ist kein Zugriff auf die API möglich.</p>
            <div class="api-key-row">
              <input id="api-key-display" class="api-key-input" type="text" readonly placeholder="Noch kein Schlüssel generiert" />
              <button id="api-key-copy-btn" class="btn btn-secondary btn-sm" type="button" title="Kopieren">
                <svg viewBox="0 0 24 24" aria-hidden="true"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              </button>
            </div>
            <div class="settings-actions">
              <button id="api-key-generate-btn" class="btn btn-secondary" type="button">
                <svg viewBox="0 0 24 24" aria-hidden="true"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                <span id="api-key-generate-label">Generieren</span>
              </button>
              <button id="api-key-save-btn" class="btn btn-primary" type="button" disabled>
                <span id="api-key-save-label">Übernehmen</span>
              </button>
            </div>
            <div id="settings-hint" class="hierarchy-hint" hidden></div>
          </div>

          <div class="settings-card" id="settings-endpoint-card" style="display:none">
            <h3 id="settings-endpoint-title">Dein API-Endpunkt</h3>
            <div class="api-endpoint-preview">
              <code id="api-endpoint-url"></code>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Confirm dialog -->
    <dialog id="dti-confirm-modal" class="dti-confirm-modal">
      <form id="dti-confirm-form" method="dialog" class="dti-confirm-form">
        <h2 id="dti-confirm-title">Änderungen übernehmen</h2>
        <p id="dti-confirm-message">Die Hierarchie-Level werden gespeichert und sind sofort über die API verfügbar. Fortfahren?</p>
        <div class="dti-confirm-actions">
          <button id="dti-confirm-cancel" class="btn btn-secondary" type="button">Abbrechen</button>
          <button id="dti-confirm-ok" class="btn btn-primary" type="submit" value="confirm">Übernehmen</button>
        </div>
      </form>
    </dialog>
  </div>

  <!-- Connector delete modal -->
  <dialog id="connector-delete-modal" class="dti-confirm-modal">
    <form id="connector-delete-form" method="dialog" class="dti-confirm-form">
      <h2 id="connector-delete-title">Connector löschen?</h2>
      <p id="connector-delete-message">Alle Daten dieses Connectors werden unwiderruflich gelöscht.</p>
      <div class="dti-confirm-actions">
        <button id="connector-delete-cancel" class="btn btn-secondary" type="button">Abbrechen</button>
        <button id="connector-delete-ok" class="btn btn-danger" type="submit" value="confirm">Löschen</button>
      </div>
    </form>
  </dialog>

  <!-- Connector import confirm modal -->
  <dialog id="connector-import-modal" class="dti-confirm-modal">
    <form id="connector-import-form" method="dialog" class="dti-confirm-form">
      <h2 id="connector-import-title">Konnektor importieren</h2>
      <p id="connector-import-message">Alle bestehenden Daten dieses Konnektors (Hierarchie, Datenmodell, Dateien und Assets) werden durch die importierten Daten ersetzt. Dieser Vorgang kann nicht rückgängig gemacht werden.</p>
      <div class="dti-confirm-actions">
        <button id="connector-import-cancel" class="btn btn-secondary" type="button">Abbrechen</button>
        <button id="connector-import-ok" class="btn btn-danger" type="submit" value="confirm">Importieren</button>
      </div>
    </form>
  </dialog>

  <input id="connector-import-file" type="file" accept=".zip" hidden />

  <!-- Share connector modal -->
  <dialog id="share-modal" class="dti-confirm-modal">
    <form method="dialog" class="dti-confirm-form share-form">
      <h2 id="share-modal-title">Konnektor teilen</h2>
      <div class="share-role-row">
        <label id="share-role-label" for="share-role-select">Rolle</label>
        <select id="share-role-select" class="export-input">
          <option value="editor">Editor</option>
          <option value="viewer">Viewer</option>
        </select>
      </div>
      <button id="share-generate-btn" type="button" class="btn btn-primary share-generate-btn">Link erstellen</button>
      <div id="share-link-box" class="share-link-box" hidden>
        <input id="share-link-input" type="text" class="export-input" readonly />
        <button id="share-copy-btn" type="button" class="btn btn-secondary share-copy-btn" title="Copy">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="5" y="5" width="9" height="9" rx="1.5" stroke="currentColor" stroke-width="1.5"/><path d="M3 11V3a1 1 0 011-1h8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </div>
      <div id="share-hint" class="hierarchy-hint" hidden></div>
      <div class="dti-confirm-actions">
        <button id="share-members-btn" type="button" class="btn btn-secondary">Mitglieder</button>
        <button type="submit" class="btn btn-secondary">Schließen</button>
      </div>
    </form>
  </dialog>

  <!-- Members modal -->
  <dialog id="members-modal" class="dti-confirm-modal">
    <form method="dialog" class="dti-confirm-form members-form">
      <h2 id="members-modal-title">Mitglieder</h2>
      <div id="members-list" class="members-list"></div>
      <div class="dti-confirm-actions">
        <button type="submit" class="btn btn-secondary">Schließen</button>
      </div>
    </form>
  </dialog>

  <dialog id="export-dialog" class="export-dialog">
    <form method="dialog">
      <h2 id="export-dialog-title">Export</h2>
      <div class="export-field">
        <label id="export-name-label" for="export-name">Dateiname</label>
        <input id="export-name" type="text" class="export-input" placeholder="hierarchy" />
      </div>
      <div class="export-field">
        <label id="export-format-label">Format</label>
        <div class="export-format-options">
          <label class="export-radio"><input type="radio" name="export-format" value="xlsx" checked /> .xlsx</label>
          <label class="export-radio"><input type="radio" name="export-format" value="csv" /> .csv</label>
        </div>
      </div>
      <div class="dti-confirm-actions">
        <button id="export-cancel" class="btn btn-secondary" type="button">Abbrechen</button>
        <button id="export-download" class="btn btn-primary" type="button">Download</button>
      </div>
    </form>
  </dialog>

  <!-- Chat Widget -->
  <div id="chat-widget-area" class="chat-widget-area" hidden>
    <button id="chat-widget-toggle" class="chat-widget-toggle" type="button" title="AI Assistant">
      <svg viewBox="0 0 24 24" class="chat-widget-icon"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
      <svg viewBox="0 0 24 24" class="chat-widget-icon-close"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>

    <div id="chat-widget" class="chat-widget" hidden>
      <div class="chat-widget-header">
        <span class="chat-widget-title">AI Assistant</span>
        <div class="chat-widget-header-actions">
          <span id="chat-widget-connector-tag" class="chat-widget-connector-tag" hidden></span>
          <button id="chat-widget-clear" class="chat-widget-clear" type="button" title="Chat leeren">
            <svg viewBox="0 0 24 24" width="16" height="16"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
          </button>
        </div>
      </div>
      <div id="chat-widget-messages" class="chat-widget-messages"></div>
      <div id="cw-slash-menu" class="cw-slash-menu" hidden></div>
      <form id="chat-widget-form" class="chat-widget-form">
        <button id="cw-mode-toggle" class="cw-mode-toggle" type="button" title="MCP / WEB">
          <svg viewBox="0 0 24 24" class="cw-mode-icon-tools"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
          <svg viewBox="0 0 24 24" class="cw-mode-icon-web"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
          <span id="cw-mode-label" class="cw-mode-label">MCP</span>
        </button>
        <textarea id="chat-widget-input" class="chat-widget-input" rows="1" placeholder="Nachricht..." maxlength="10000"></textarea>
        <button type="submit" id="chat-widget-send" class="chat-widget-send" disabled>
          <svg viewBox="0 0 24 24" width="16" height="16"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
        </button>
      </form>
    </div>
  </div>

  <script src="/apps/dti-connector/app.js"></script>
</body>
</html>
